
![](./mpa0Xegt9EkIhm1myAZVc5NaRPKq3qb1.svg)

(demo的层的顺序 黑蓝紫)

从下到上一层一层堆叠, 每一层的计算内部, 可以从高到低, 这样就能避免拓展和拓展有重叠的问题

数据结构

维护数据对象需要有两个, 一个记录材料信息:record, 一个只维持最顶层的高度:top

+ `top={高度:[多边形]}`
+ `record=[(多边形,zmax,zmin,材料id)]`

record只增不会减, 是材料的忠实记录, 一条条追加不会改已有的

top会及时更新, top总是完整的仿真区域矩形的不重不漏的划分, 非常类似深度缓冲区, (每个高度内可以merge, 而且是最好merge掉), 高度可以用"优先队列"维护.

以及一个临时的区域: 当次新放的层. 要循环直到其为空, 依次拆分进record和top

涉及的运算

多边形/区域 的扩张, 理论上扩出来的拐角需要是圆
多边形/区域 的 交/并/差

复杂度

所有图层的总多边形数n, 目测是`O(n^3)`次多边形级的运算
